<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calvin Ma</title>
    <!-- Link to Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        /* Styles omitted for brevity; they remain unchanged */
    </style>
</head>
<body>

    <!-- Hero section -->
    <section class="hero">
        <img src="toronto futuristic.webp" alt="Toronto skyline">
        <h1 class="name-overlay">Calvin Ma</h1> <!-- Centered title with outline -->
    </section>

    <!-- Stock Price Prediction Form -->
    <h2>Enter a Stock Ticker (e.g., AAPL) to predict the next day's price</h2>
    <p>Predict tomorrow's stock price with 60 days of data through an exponential moving average forecasting model</p>
    <p>Built with AWS Lambda and API Gateway</p>
    <form id="tickerForm">
        <label for="ticker">Ticker Symbol:</label>
        <input type="text" id="ticker" name="ticker" required>
        <button type="submit">Get Prediction</button>
    </form>
    <p id="result"></p>

    <!-- JavaScript for Stock Prediction -->
    <script>
        document.getElementById('tickerForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevent form from refreshing the page
            
            const ticker = document.getElementById('ticker').value.trim().toUpperCase();
            const apiUrl = `https://hikjoibv7e64w5ketu4dpb4kjm0squjj.lambda-url.ca-central-1.on.aws/?ticker=${ticker}`;
            
            try {
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                const predictedPrice = data.body; // Assuming the API returns a field named 'body'
                
                // Get tomorrow's date
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const tomorrowStr = tomorrow.toISOString().split('T')[0];
                
                // Display the result
                document.getElementById('result').innerText = 
                    `The stock price for ${ticker} for ${tomorrowStr} is predicted to be ${predictedPrice}. This is not financial advice.`;
            } catch (error) {
                document.getElementById('result').innerText = 
                    'An error occurred. Please check the ticker symbol and try again.';
                console.error('Error:', error);
            }
        });
    </script>

    <!-- Projects Section -->
    <div class="container">
        <!-- Project sections omitted for brevity; they remain unchanged -->
    </div>

    <!-- Publications Section -->
    <div class="container">
        <!-- Publications sections omitted for brevity; they remain unchanged -->
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2024 Calvin Ma. All Rights Reserved.</p>
    </footer>

    <!-- JavaScript for Project Preview -->
    <script>
        const previewData = {
            'project1': `<iframe src="project1.pdf" class="iframe-container"></iframe>`,
            'project2': `<iframe src="project2.pdf" class="iframe-container"></iframe>`,
            'project3': `<iframe src="project3.pdf" class="iframe-container"></iframe>`,
            'project4': `<iframe src="project4.pdf" class="iframe-container"></iframe>`,
            'project5': `<iframe src="project5.pdf" class="iframe-container"></iframe>`
        };

        let currentProject = null; // Track the current project being shown

        function showPreview(projectId) {
            const previewSection = document.getElementById('portfolio-preview');
            const previewFrame = document.getElementById('preview-frame');

            // Toggle visibility if the same project is clicked again
            if (currentProject === projectId) {
                previewSection.classList.toggle('active');
                currentProject = previewSection.classList.contains('active') ? projectId : null;
            } else {
                previewFrame.innerHTML = previewData[projectId];
                previewSection.classList.add('active');
                currentProject = projectId;
            }
        }
    </script>
</body>
</html>
